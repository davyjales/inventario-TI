# Correção do Problema de Histórico Duplicado

## Problema
Ao fazer uma alteração em um equipamento, são criados dois históricos:
1. Um através do `cloneEquipmentToHistory` (snapshot completo)
2. Outro através do `logEquipmentChange` (apenas mudanças)

## Solução
Unificar as duas abordagens em uma única função que combine o melhor dos dois mundos.

## Tarefas

### 1. Modificar cloneEquipmentToHistory.js ✅
- [x] Adicionar lógica para filtrar apenas mudanças reais (como logEquipmentChange)
- [x] Para updates, salvar apenas as mudanças no changed_fields
- [x] Manter snapshot completo apenas para create/consulta

### 2. Modificar equipamentosService.js
- [ ] Remover a segunda chamada duplicada para logEquipmentChange
- [ ] Manter apenas a chamada para cloneEquipmentToHistory
- [ ] Garantir que as mudanças sejam passadas corretamente

### 3. Testar a correção
- [ ] Fazer uma alteração em um equipamento
- [ ] Verificar se apenas um histórico é criado
- [ ] Confirmar que o modal de detalhes funciona
- [ ] Confirmar que o botão "Mostrar Alterações" funciona

## Status: Em andamento
